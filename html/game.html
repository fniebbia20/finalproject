<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>2048 â€“ Light Blue Edition</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
:root {
  --bg: #e6f3fb;
  --board: #bcdff1;
  --cell: #d9edf7;
  --text: #1f3b4d;
  --accent: #5aa9e6;
  --speed: 150ms;
}

body {
  font-family: "Segoe UI", system-ui, sans-serif;
  background: var(--bg);
  color: var(--text);
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
}

.container {
  width: 360px;
}

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

h1 {
  margin: 0;
  font-size: 2rem;
}

.score-box {
  background: var(--accent);
  color: white;
  padding: 8px 12px;
  border-radius: 8px;
  font-weight: bold;
  text-align: center;
  min-width: 90px;
}

.controls {
  margin: 12px 0;
  font-size: 0.9rem;
}

.controls input {
  width: 100%;
}

button {
  width: 100%;
  margin-top: 8px;
  padding: 10px;
  background: var(--accent);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: bold;
  cursor: pointer;
}

button:hover {
  opacity: 0.9;
}

.board {
  background: var(--board);
  padding: 10px;
  border-radius: 12px;
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  position: relative;
}

.cell {
  background: var(--cell);
  border-radius: 8px;
  width: 100%;
  padding-top: 100%;
}

.tile {
  position: absolute;
  width: calc(25% - 10px);
  height: calc(25% - 10px);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 1.6rem;
  transition: transform var(--speed) ease, background-color 0.2s;
}

.tile[data-value="2"]   { background: #e8f4ff; }
.tile[data-value="4"]   { background: #d0ebff; }
.tile[data-value="8"]   { background: #a9d6f5; color: white; }
.tile[data-value="16"]  { background: #7fc1ee; color: white; }
.tile[data-value="32"]  { background: #5aa9e6; color: white; }
.tile[data-value="64"]  { background: #2f8dd8; color: white; }
.tile[data-value="128"] { background: #1c6fb8; color: white; }
.tile[data-value="256"] { background: #155a94; color: white; }
.tile[data-value="512"] { background: #0f446f; color: white; }
.tile[data-value="1024"],
.tile[data-value="2048"] { background: #0a2f4f; color: white; }

.overlay {
  position: absolute;
  inset: 0;
  background: rgba(230,243,251,0.9);
  display: none;
  align-items: center;
  justify-content: center;
  font-size: 2rem;
  font-weight: bold;
  border-radius: 12px;
}

.overlay.show {
  display: flex;
}
</style>
</head>

<body>
<div class="container">
  <header>
    <h1>2048</h1>
    <div class="score-box">Score<br><span id="score">0</span></div>
  </header>

  <div class="controls">
    Animation Speed
    <input type="range" min="50" max="400" value="150" id="speed">
    <button id="restart">Restart Game</button>
  </div>

  <div class="board" id="board">
    <div class="overlay" id="overlay"></div>
    <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
    <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
    <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
    <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
  </div>
</div>

<script>
const board = document.getElementById("board");
const scoreEl = document.getElementById("score");
const overlay = document.getElementById("overlay");
const speedInput = document.getElementById("speed");
const restartBtn = document.getElementById("restart");

let grid, score;

function setSpeed() {
  document.documentElement.style.setProperty("--speed", speedInput.value + "ms");
}
speedInput.addEventListener("input", setSpeed);

function resetGame() {
  grid = Array.from({ length: 4 }, () => Array(4).fill(0));
  score = 0;
  overlay.classList.remove("show");
  addTile();
  addTile();
  draw();
}

function addTile() {
  const empty = [];
  for (let r = 0; r < 4; r++)
    for (let c = 0; c < 4; c++)
      if (grid[r][c] === 0) empty.push({ r, c });

  if (!empty.length) return;
  const { r, c } = empty[Math.floor(Math.random() * empty.length)];
  grid[r][c] = Math.random() < 0.9 ? 2 : 4;
}

function draw() {
  document.querySelectorAll(".tile").forEach(t => t.remove());
  for (let r = 0; r < 4; r++) {
    for (let c = 0; c < 4; c++) {
      if (grid[r][c]) {
        const tile = document.createElement("div");
        tile.className = "tile";
        tile.dataset.value = grid[r][c];
        tile.textContent = grid[r][c];
        tile.style.transform = `translate(${c * 90 + 10}px, ${r * 90 + 10}px)`;
        board.appendChild(tile);
      }
    }
  }
  scoreEl.textContent = score;
}

function slide(row) {
  row = row.filter(v => v);
  for (let i = 0; i < row.length - 1; i++) {
    if (row[i] === row[i + 1]) {
      row[i] *= 2;
      score += row[i];
      row[i + 1] = 0;
    }
  }
  return row.filter(v => v);
}

function move(dir) {
  let moved = false;
  for (let i = 0; i < 4; i++) {
    let line;
    if (dir === "left" || dir === "right") {
      line = grid[i].slice();
      if (dir === "right") line.reverse();
      let merged = slide(line);
      while (merged.length < 4) merged.push(0);
      if (dir === "right") merged.reverse();
      if (merged.join() !== grid[i].join()) moved = true;
      grid[i] = merged;
    } else {
      line = grid.map(r => r[i]);
      if (dir === "down") line.reverse();
      let merged = slide(line);
      while (merged.length < 4) merged.push(0);
      if (dir === "down") merged.reverse();
      for (let r = 0; r < 4; r++) {
        if (grid[r][i] !== merged[r]) moved = true;
        grid[r][i] = merged[r];
      }
    }
  }
  if (moved) {
    addTile();
    draw();
    checkGame();
  }
}

function checkGame() {
  for (let r = 0; r < 4; r++)
    for (let c = 0; c < 4; c++)
      if (grid[r][c] === 2048) {
        overlay.textContent = "You Win!";
        overlay.classList.add("show");
        return;
      }

  for (let r = 0; r < 4; r++)
    for (let c = 0; c < 4; c++) {
      if (grid[r][c] === 0) return;
      if (grid[r][c] === (grid[r + 1]?.[c] ?? null)) return;
      if (grid[r][c] === (grid[r]?.[c + 1] ?? null)) return;
    }

  overlay.textContent = "Game Over";
  overlay.classList.add("show");
}

document.addEventListener("keydown", e => {
  if (overlay.classList.contains("show")) return;
  if (e.key === "ArrowLeft") move("left");
  if (e.key === "ArrowRight") move("right");
  if (e.key === "ArrowUp") move("up");
  if (e.key === "ArrowDown") move("down");
});

restartBtn.addEventListener("click", resetGame);

// Touch support
let sx, sy;
board.addEventListener("touchstart", e => {
  sx = e.touches[0].clientX;
  sy = e.touches[0].clientY;
});
board.addEventListener("touchend", e => {
  const dx = e.changedTouches[0].clientX - sx;
  const dy = e.changedTouches[0].clientY - sy;
  if (Math.abs(dx) > Math.abs(dy)) {
    if (dx > 30) move("right");
    if (dx < -30) move("left");
  } else {
    if (dy > 30) move("down");
    if (dy < -30) move("up");
  }
});

// Init
setSpeed();
resetGame();
</script>
</body>
</html>